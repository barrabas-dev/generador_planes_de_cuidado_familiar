{1:"Ahora vamos a crear un modulo en pýthon que se encargara de leer otra encuesta que solo contendra informacion por nucleo familiar.

La tabla contendra los siquientes encabezados,
FECHA DE LA VISITA  
NUCLEO FAMILIAR  
RESULTADO DEL APGAR  
COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES  
INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD  
RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO  
ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES  
RIESGO DE MAL NUTRICIÓN  
ACTIVIDADES DEPORTIVAS COMUNITARIAS  
ACTIVIDADES LÚDICAS Y CULTURALES COMUNITARIAS  
RED DE APOYO COMUNITARIO  
SOBRECARGA DE CUIDADOR

se extraeran datos de id como el nucleo familia, el resultado de una prueba apgar y fecha.

tambien se extraera un listado de booleanos:
COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES  
INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD  
RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO  
ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES  
RIESGO DE MAL NUTRICIÓN  
ACTIVIDADES DEPORTIVAS COMUNITARIAS  
ACTIVIDADES LÚDICAS Y CULTURALES COMUNITARIAS  
RED DE APOYO COMUNITARIO  
SOBRECARGA DE CUIDADOR,

las celdas marcadas con x se asumiran como "true" y las vacias como "false"

los encabezados de la encuesta estaran ubicados en la linea 2 de la hoja

"}


{2:tengo un modulo llamado excel exporter, voy a reutilizarlo en otro proyecto, este modulo se encarga de crear copias de una plantilla de excel para luego diligenciarla, pero trabaja por nucleo familiares y crea hojas dependiendo de sus integrantes desde un solo diccionario, 
El nuevo modulo se encargara de crear planes de cuidado familires uno por nucleo. solo contendra una hoja por nucleo y trabajar con dos diccionarios uno que contendra la informacion de los integantes de los nucleo es el mismo de la anterior mudulo y ademas de un nuevo diccionario que contendra informacion adicional por nucleo ejemplo.

(--- Núcleo Familiar: H0073 ---
Fecha de la Visita: 2025-05-12
Resultado del APGAR: 17 A 20
Factores identificados:
  COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES: False
  INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD: False
  RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO: False
  ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES: False
  RIESGO DE MAL NUTRICIÓN: False
  ACTIVIDADES DEPORTIVAS COMUNITARIAS: True
  ACTIVIDADES LÚDICAS Y CULTURALES COMUNITARIAS: False
  RED DE APOYO COMUNITARIO: False
  SOBRECARGA DE CUIDADOR: False

--- Núcleo Familiar: H0074 ---
Fecha de la Visita: 2025-05-12
Resultado del APGAR: 16 A 13
Factores identificados:
  COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES: False
  INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD: False
  RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO: False
  ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES: False
  RIESGO DE MAL NUTRICIÓN: False
  ACTIVIDADES DEPORTIVAS COMUNITARIAS: True
  ACTIVIDADES LÚDICAS Y CULTURALES COMUNITARIAS: False
  RED DE APOYO COMUNITARIO: False
  SOBRECARGA DE CUIDADOR: False)
ayudame teniendo en cuenta el codigo que te voy a proporcionar, a crear este nuevo modulo, donde me cree una copia de la plantilla por nucleo familiar teniendo como fuente el segundo diccionario ya que no se crearan planes para todos los nucleos, solo para los elejidos en el segundo diccionario.

Este modulo se utilizara en un proyecto profesional, por favr maneja buenas practicas y comenta con claridad para entender mejor.

(import os
import shutil
from openpyxl import load_workbook
from openpyxl.utils import get_column_letter
from datetime import datetime
from situaciones_encontradas import llenar_situaciones_en_hoja, llenar_desarrollo_por_etapa, llenar_area_afectiva_en_hoja, llenar_area_personal_en_hoja, llenar_area_social_en_hoja, llenar_area_educativa_ocupacional_en_hoja, llenar_acciones_en_hoja, llenar_area_impresion_diagnostica_en_hoja, llenar_plan_intervencion_en_hoja, llenar_area_conclusion_en_hoja




def copiar_hoja(wb, hoja_origen, nuevo_nombre):
    """
    Crea una copia de una hoja dentro del libro con un nuevo nombre.
    """
    nueva_hoja = wb.copy_worksheet(hoja_origen)
    nueva_hoja.title = nuevo_nombre
    return nueva_hoja


def crear_planes_cuidado(dato_nucleos: dict, plantilla_path: str, salida_dir: str):
    """
    Genera archivos Excel por hogar con hojas individuales por persona seleccionada.

    :param dato_nucleos: Diccionario con hogares e integrantes.
    :param plantilla_path: Ruta al archivo plantilla Excel.
    :param salida_dir: Carpeta destino para los archivos generados.
    """

    if not os.path.isfile(plantilla_path):
        raise FileNotFoundError(f"Plantilla no encontrada: {plantilla_path}")

    os.makedirs(salida_dir, exist_ok=True)


    for hogar_id, hogar_info in dato_nucleos.items():
        seleccionados = [
            p for p in hogar_info["integrantes"] if p.get("SELECCIONADO") is True
        ]

        if not seleccionados:
            continue

        # Crear archivo base desde plantilla
        hogar_filename = f"{hogar_id}.xlsx"
        hogar_path = os.path.join(salida_dir, hogar_filename)
        shutil.copy(plantilla_path, hogar_path)

        wb = load_workbook(hogar_path)
        hoja_modelo = wb.worksheets[0]  # Primera hoja como base

        # Procesar el primer seleccionado usando la hoja original
        primera_persona = seleccionados[0]
        hoja_modelo.title = primera_persona["NUMERO DE IDENTIFICACIÓN"]

        # Rellenar datos en la hoja base
        llenar_datos_en_hoja(hoja_modelo, primera_persona, hogar_info["integrantes"])
        insertar_imagenes_familiares(hoja_modelo, primera_persona["HOGAR"], "A21")
        insertar_texto_analisis(hoja_modelo, primera_persona["HOGAR"], "A23")
        total_hojas_generadas += 1  # Contar esta hoja


        # Para los demás seleccionados, duplicar la hoja base
        for persona in seleccionados[1:]:
            nueva_hoja = copiar_hoja(wb, hoja_modelo, persona["NUMERO DE IDENTIFICACIÓN"])
            llenar_datos_en_hoja(nueva_hoja, persona, hogar_info["integrantes"])
            insertar_imagenes_familiares(nueva_hoja, persona["HOGAR"], "A21")
            insertar_texto_analisis(nueva_hoja, persona["HOGAR"], "A23")
            total_hojas_generadas += 1  # Contar esta hoja


        wb.save(hogar_path)

    print(f"✅ Planes generados en: {salida_dir}"))}

#-------------------
{3:quiero Convertir a un formato serializable (los dataclass se transforman en dicts primero){('H0003': EvaluacionFamiliar(fecha_visita='2025-05-05',
                             nucleo_familiar='H0003',
                             resultado_apgar='17 A 20',
                             factores={'ACTIVIDADES DEPORTIVAS COMUNITARIAS': True,
                                       'ACTIVIDADES LÚDICAS Y CULTURALES COMUNITARIAS': False,
                                       'COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES': False,
                                       'ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES': False,
                                       'INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD': False,
                                       'RED DE APOYO COMUNITARIO': False,
                                       'RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO': False,
                                       'RIESGO DE MAL NUTRICIÓN': False,
                                       'SOBRECARGA DE CUIDADOR': False}),
 'H0004': EvaluacionFamiliar(fecha_visita='2025-05-05',
                             nucleo_familiar='H0004',
                             resultado_apgar='17 A 20',
                             factores={'ACTIVIDADES DEPORTIVAS COMUNITARIAS': True,
                                       'ACTIVIDADES LÚDICAS Y CULTURALES COMUNITARIAS': False,
                                       'COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES': False,
                                       'ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES': False,
                                       'INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD': False,
                                       'RED DE APOYO COMUNITARIO': False,
                                       'RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO': False,
                                       'RIESGO DE MAL NUTRICIÓN': False,
                                       'SOBRECARGA DE CUIDADOR': False}),
 'H0005': EvaluacionFamiliar(fecha_visita='2025-05-05',
                             nucleo_familiar='H0005',
                             resultado_apgar='16 A 13',
                             factores={'ACTIVIDADES DEPORTIVAS COMUNITARIAS': True,
                                       'ACTIVIDADES LÚDICAS Y CULTURALES COMUNITARIAS': False,
                                       'COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES': False,
                                       'ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES': False,
                                       'INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD': False,
                                       'RED DE APOYO COMUNITARIO': False,
                                       'RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO': False,
                                       'RIESGO DE MAL NUTRICIÓN': False,
                                       'SOBRECARGA DE CUIDADOR': False}),}}


#-------------------------------------------------
{4: Debo extraer informacion del diccionario 'planes_nucleos' para llenar las celdas de datos personales, debo extraer el nombre de la primera persona que compone el nucleo familiar para diligenciar la celda B:13}


{5: Nececito generar una funcion en python que dependiendo a un resultado apgar que se obtendra de un string me entregue seleccione el acuerdo correspóndiente, este texto se extraera de un diccionario:

{acuerdos_apgar = {
    "17-20": {
        "titulo": "Fortalecimiento de capacidades y liderazgo familiar",
        "acuerdo": (
            "Se fortalecerán las capacidades del núcleo familiar para sostener prácticas saludables de "
            "alimentación, higiene, autocuidado y asistencia regular a servicios de salud. Además, se promoverá "
            "el liderazgo familiar en la comunidad, la participación en espacios colectivos y el desarrollo de "
            "redes de apoyo solidarias, reconociendo su rol activo en la promoción del bienestar integral y la "
            "consolidación de vínculos afectivos positivos."
        )
    },
    "16-13": {
        "titulo": "Mejoramiento de hábitos y organización familiar",
        "acuerdo": (
            "Se brindará acompañamiento para mejorar hábitos cotidianos de cuidado, promoviendo una comunicación "
            "más efectiva, la organización de rutinas familiares, el cumplimiento de controles de salud y la "
            "distribución de responsabilidades en el hogar. Estas acciones buscan fortalecer el funcionamiento "
            "familiar, reducir tensiones y fomentar un entorno protector que favorezca el desarrollo de sus "
            "integrantes."
        )
    },
    "12-10": {
        "titulo": "Intervención para la mejora de vínculos y convivencia",
        "acuerdo": (
            "Se implementará un plan de intervención familiar con énfasis en el fortalecimiento de vínculos, el "
            "manejo de conflictos y la reorganización de roles. Se facilitará el acceso a servicios sociales y "
            "de salud, así como la participación en espacios psicoeducativos para mejorar la convivencia, la "
            "toma de decisiones compartida y el establecimiento de normas básicas de funcionamiento."
        )
    },
    "9": {
        "titulo": "Abordaje integral y restitución de derechos",
        "acuerdo": (
            "Se gestionará un abordaje integral e intensivo que priorice la protección de los miembros más "
            "vulnerables del núcleo familiar, mediante intervenciones psicosociales, jurídicas y de salud. Se "
            "orientará a la familia hacia la reconstrucción de sus relaciones internas, el restablecimiento de "
            "condiciones mínimas de cuidado y la articulación con instituciones que garanticen la restitución "
            "de derechos y la contención emocional."
        )
    }
}
}

Quiero que la funcion me retorne el string, este string se usara para diligenciar una celda en excel por otra funcion.

Maneja buenas practicas, comenta para entender la funcion, ya que esto se usara para un proyecto profesional.

}

{5: Necesito crear una funcion la que dependiendo de la calificacion apgar que recibira la funcion como string, me returne una tupla con cuatro fortalezas, cada unidad de la tupla contedra el valor contenido en el diccionario con el que trabajaremos, el diccionario esta compuesto de la calificacion apgar(17 A 20, 16 A 13, 12 A 10, 9) y claves:valor con las descripciones de las frotalezas. 

fortalezas_apgar = {
    "17-20": {
        "FORTALEZA 1": "Los miembros de la familia expresan libremente sus emociones, positivas y negativas. Esta comunicación emocional fortalece los vínculos afectivos y promueve la comprensión, la aceptación y la escucha activa.",
        "FORTALEZA 2": "Existe un diálogo abierto donde se valoran todas las opiniones. La familia resuelve conflictos de forma pacífica, con comprensión mutua y trabajo colaborativo ante desacuerdos cotidianos.",
        "FORTALEZA 3": "La familia se reorganiza de forma efectiva ante cambios o dificultades, tomando decisiones conjuntas y buscando apoyo externo si es necesario. Mantienen una actitud resiliente.",
        "FORTALEZA 4": "Todos los miembros se sienten respaldados y emocionalmente seguros, especialmente en momentos difíciles. El apoyo constante crea un ambiente confiable y protector."
    },
    "16-13": {
        "FORTALEZA 1": "Aunque hay disposición, existen dificultades ocasionales para expresar emociones, lo que puede generar malentendidos y limitar la conexión emocional.",
        "FORTALEZA 2": "Se intenta mantener la comunicación, pero los desacuerdos pueden generar tensiones. A veces se evita abordar los problemas directamente, lo que impide acuerdos duraderos.",
        "FORTALEZA 3": "La familia intenta reorganizarse ante situaciones adversas, aunque con dificultades para manejar el estrés. Puede haber incertidumbre que afecta el funcionamiento familiar temporalmente.",
        "FORTALEZA 4": "Hay reconocimiento del apoyo mutuo, pero no siempre es constante. Pueden surgir sentimientos de soledad o falta de contención emocional en momentos críticos."
    },
    "12-10": {
        "FORTALEZA 1": "La expresión emocional es limitada. Frecuentemente se evitan conversaciones sobre emociones, lo que debilita la empatía y la conexión afectiva.",
        "FORTALEZA 2": "La comunicación es ineficaz. Los conflictos suelen escalar y resolverse de forma poco saludable. Prevalece el silencio, la evasión o reacciones impulsivas.",
        "FORTALEZA 3": "Hay desorganización y poca coordinación frente a dificultades. Las decisiones son fragmentadas, y algunos miembros experimentan sobrecarga emocional.",
        "FORTALEZA 4": "Varios miembros no se sienten apoyados o seguros. En momentos difíciles, puede faltar contención, generando vulnerabilidad emocional, especialmente en los más sensibles."
    },
    "9": {
        "FORTALEZA 1": "Existe una profunda dificultad para compartir emociones. Esto genera aislamiento emocional, resentimientos acumulados y desconexión afectiva.",
        "FORTALEZA 2": "Los conflictos se evitan o se manejan de forma destructiva. No hay espacios seguros de diálogo y la falta de respeto y escucha deteriora la dinámica familiar.",
        "FORTALEZA 3": "La familia no logra reorganizarse ni apoyarse mutuamente ante adversidades. El afrontamiento es individual y caótico, lo que perpetúa una sensación de crisis.",
        "FORTALEZA 4": "El sentimiento de protección es muy bajo. En situaciones difíciles, los miembros se sienten desatendidos, lo que impacta su salud emocional y física."
    }
}

}