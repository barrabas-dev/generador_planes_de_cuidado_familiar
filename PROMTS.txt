{1:"Ahora vamos a crear un modulo en pýthon que se encargara de leer otra encuesta que solo contendra informacion por nucleo familiar.

La tabla contendra los siquientes encabezados,
FECHA DE LA VISITA  
NUCLEO FAMILIAR  
RESULTADO DEL APGAR  
COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES  
INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD  
RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO  
ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES  
RIESGO DE MAL NUTRICIÓN  
ACTIVIDADES DEPORTIVAS COMUNITARIAS  
ACTIVIDADES LÚDICAS Y CULTURALES COMUNITARIAS  
RED DE APOYO COMUNITARIO  
SOBRECARGA DE CUIDADOR

se extraeran datos de id como el nucleo familia, el resultado de una prueba apgar y fecha.

tambien se extraera un listado de booleanos:
COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES  
INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD  
RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO  
ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES  
RIESGO DE MAL NUTRICIÓN  
ACTIVIDADES DEPORTIVAS COMUNITARIAS  
ACTIVIDADES LÚDICAS Y CULTURALES COMUNITARIAS  
RED DE APOYO COMUNITARIO  
SOBRECARGA DE CUIDADOR,

las celdas marcadas con x se asumiran como "true" y las vacias como "false"

los encabezados de la encuesta estaran ubicados en la linea 2 de la hoja

"}


{2:tengo un modulo llamado excel exporter, voy a reutilizarlo en otro proyecto, este modulo se encarga de crear copias de una plantilla de excel para luego diligenciarla, pero trabaja por nucleo familiares y crea hojas dependiendo de sus integrantes desde un solo diccionario, 
El nuevo modulo se encargara de crear planes de cuidado familires uno por nucleo. solo contendra una hoja por nucleo y trabajar con dos diccionarios uno que contendra la informacion de los integantes de los nucleo es el mismo de la anterior mudulo y ademas de un nuevo diccionario que contendra informacion adicional por nucleo ejemplo.

(--- Núcleo Familiar: H0073 ---
Fecha de la Visita: 2025-05-12
Resultado del APGAR: 17 A 20
Factores identificados:
  COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES: False
  INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD: False
  RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO: False
  ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES: False
  RIESGO DE MAL NUTRICIÓN: False
  ACTIVIDADES DEPORTIVAS COMUNITARIAS: True
  ACTIVIDADES LÚDICAS Y CULTURALES COMUNITARIAS: False
  RED DE APOYO COMUNITARIO: False
  SOBRECARGA DE CUIDADOR: False

--- Núcleo Familiar: H0074 ---
Fecha de la Visita: 2025-05-12
Resultado del APGAR: 16 A 13
Factores identificados:
  COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES: False
  INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD: False
  RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO: False
  ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES: False
  RIESGO DE MAL NUTRICIÓN: False
  ACTIVIDADES DEPORTIVAS COMUNITARIAS: True
  ACTIVIDADES LÚDICAS Y CULTURALES COMUNITARIAS: False
  RED DE APOYO COMUNITARIO: False
  SOBRECARGA DE CUIDADOR: False)
ayudame teniendo en cuenta el codigo que te voy a proporcionar, a crear este nuevo modulo, donde me cree una copia de la plantilla por nucleo familiar teniendo como fuente el segundo diccionario ya que no se crearan planes para todos los nucleos, solo para los elejidos en el segundo diccionario.

Este modulo se utilizara en un proyecto profesional, por favr maneja buenas practicas y comenta con claridad para entender mejor.

(import os
import shutil
from openpyxl import load_workbook
from openpyxl.utils import get_column_letter
from datetime import datetime
from situaciones_encontradas import llenar_situaciones_en_hoja, llenar_desarrollo_por_etapa, llenar_area_afectiva_en_hoja, llenar_area_personal_en_hoja, llenar_area_social_en_hoja, llenar_area_educativa_ocupacional_en_hoja, llenar_acciones_en_hoja, llenar_area_impresion_diagnostica_en_hoja, llenar_plan_intervencion_en_hoja, llenar_area_conclusion_en_hoja




def copiar_hoja(wb, hoja_origen, nuevo_nombre):
    """
    Crea una copia de una hoja dentro del libro con un nuevo nombre.
    """
    nueva_hoja = wb.copy_worksheet(hoja_origen)
    nueva_hoja.title = nuevo_nombre
    return nueva_hoja


def crear_planes_cuidado(dato_nucleos: dict, plantilla_path: str, salida_dir: str):
    """
    Genera archivos Excel por hogar con hojas individuales por persona seleccionada.

    :param dato_nucleos: Diccionario con hogares e integrantes.
    :param plantilla_path: Ruta al archivo plantilla Excel.
    :param salida_dir: Carpeta destino para los archivos generados.
    """

    if not os.path.isfile(plantilla_path):
        raise FileNotFoundError(f"Plantilla no encontrada: {plantilla_path}")

    os.makedirs(salida_dir, exist_ok=True)


    for hogar_id, hogar_info in dato_nucleos.items():
        seleccionados = [
            p for p in hogar_info["integrantes"] if p.get("SELECCIONADO") is True
        ]

        if not seleccionados:
            continue

        # Crear archivo base desde plantilla
        hogar_filename = f"{hogar_id}.xlsx"
        hogar_path = os.path.join(salida_dir, hogar_filename)
        shutil.copy(plantilla_path, hogar_path)

        wb = load_workbook(hogar_path)
        hoja_modelo = wb.worksheets[0]  # Primera hoja como base

        # Procesar el primer seleccionado usando la hoja original
        primera_persona = seleccionados[0]
        hoja_modelo.title = primera_persona["NUMERO DE IDENTIFICACIÓN"]

        # Rellenar datos en la hoja base
        llenar_datos_en_hoja(hoja_modelo, primera_persona, hogar_info["integrantes"])
        insertar_imagenes_familiares(hoja_modelo, primera_persona["HOGAR"], "A21")
        insertar_texto_analisis(hoja_modelo, primera_persona["HOGAR"], "A23")
        total_hojas_generadas += 1  # Contar esta hoja


        # Para los demás seleccionados, duplicar la hoja base
        for persona in seleccionados[1:]:
            nueva_hoja = copiar_hoja(wb, hoja_modelo, persona["NUMERO DE IDENTIFICACIÓN"])
            llenar_datos_en_hoja(nueva_hoja, persona, hogar_info["integrantes"])
            insertar_imagenes_familiares(nueva_hoja, persona["HOGAR"], "A21")
            insertar_texto_analisis(nueva_hoja, persona["HOGAR"], "A23")
            total_hojas_generadas += 1  # Contar esta hoja


        wb.save(hogar_path)

    print(f"✅ Planes generados en: {salida_dir}"))}

#-------------------
{3:quiero Convertir a un formato serializable (los dataclass se transforman en dicts primero){('H0003': EvaluacionFamiliar(fecha_visita='2025-05-05',
                             nucleo_familiar='H0003',
                             resultado_apgar='17 A 20',
                             factores={'ACTIVIDADES DEPORTIVAS COMUNITARIAS': True,
                                       'ACTIVIDADES LÚDICAS Y CULTURALES COMUNITARIAS': False,
                                       'COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES': False,
                                       'ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES': False,
                                       'INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD': False,
                                       'RED DE APOYO COMUNITARIO': False,
                                       'RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO': False,
                                       'RIESGO DE MAL NUTRICIÓN': False,
                                       'SOBRECARGA DE CUIDADOR': False}),
 'H0004': EvaluacionFamiliar(fecha_visita='2025-05-05',
                             nucleo_familiar='H0004',
                             resultado_apgar='17 A 20',
                             factores={'ACTIVIDADES DEPORTIVAS COMUNITARIAS': True,
                                       'ACTIVIDADES LÚDICAS Y CULTURALES COMUNITARIAS': False,
                                       'COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES': False,
                                       'ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES': False,
                                       'INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD': False,
                                       'RED DE APOYO COMUNITARIO': False,
                                       'RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO': False,
                                       'RIESGO DE MAL NUTRICIÓN': False,
                                       'SOBRECARGA DE CUIDADOR': False}),
 'H0005': EvaluacionFamiliar(fecha_visita='2025-05-05',
                             nucleo_familiar='H0005',
                             resultado_apgar='16 A 13',
                             factores={'ACTIVIDADES DEPORTIVAS COMUNITARIAS': True,
                                       'ACTIVIDADES LÚDICAS Y CULTURALES COMUNITARIAS': False,
                                       'COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES': False,
                                       'ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES': False,
                                       'INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD': False,
                                       'RED DE APOYO COMUNITARIO': False,
                                       'RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO': False,
                                       'RIESGO DE MAL NUTRICIÓN': False,
                                       'SOBRECARGA DE CUIDADOR': False}),}}


#-------------------------------------------------
{4: Debo extraer informacion del diccionario 'planes_nucleos' para llenar las celdas de datos personales, debo extraer el nombre de la primera persona que compone el nucleo familiar para diligenciar la celda B:13}


{5: Nececito generar una funcion en python que dependiendo a un resultado apgar que se obtendra de un string me entregue seleccione el acuerdo correspóndiente, este texto se extraera de un diccionario:

{acuerdos_apgar = {
    "17-20": {
        "titulo": "Fortalecimiento de capacidades y liderazgo familiar",
        "acuerdo": (
            "Se fortalecerán las capacidades del núcleo familiar para sostener prácticas saludables de "
            "alimentación, higiene, autocuidado y asistencia regular a servicios de salud. Además, se promoverá "
            "el liderazgo familiar en la comunidad, la participación en espacios colectivos y el desarrollo de "
            "redes de apoyo solidarias, reconociendo su rol activo en la promoción del bienestar integral y la "
            "consolidación de vínculos afectivos positivos."
        )
    },
    "16-13": {
        "titulo": "Mejoramiento de hábitos y organización familiar",
        "acuerdo": (
            "Se brindará acompañamiento para mejorar hábitos cotidianos de cuidado, promoviendo una comunicación "
            "más efectiva, la organización de rutinas familiares, el cumplimiento de controles de salud y la "
            "distribución de responsabilidades en el hogar. Estas acciones buscan fortalecer el funcionamiento "
            "familiar, reducir tensiones y fomentar un entorno protector que favorezca el desarrollo de sus "
            "integrantes."
        )
    },
    "12-10": {
        "titulo": "Intervención para la mejora de vínculos y convivencia",
        "acuerdo": (
            "Se implementará un plan de intervención familiar con énfasis en el fortalecimiento de vínculos, el "
            "manejo de conflictos y la reorganización de roles. Se facilitará el acceso a servicios sociales y "
            "de salud, así como la participación en espacios psicoeducativos para mejorar la convivencia, la "
            "toma de decisiones compartida y el establecimiento de normas básicas de funcionamiento."
        )
    },
    "9": {
        "titulo": "Abordaje integral y restitución de derechos",
        "acuerdo": (
            "Se gestionará un abordaje integral e intensivo que priorice la protección de los miembros más "
            "vulnerables del núcleo familiar, mediante intervenciones psicosociales, jurídicas y de salud. Se "
            "orientará a la familia hacia la reconstrucción de sus relaciones internas, el restablecimiento de "
            "condiciones mínimas de cuidado y la articulación con instituciones que garanticen la restitución "
            "de derechos y la contención emocional."
        )
    }
}
}

Quiero que la funcion me retorne el string, este string se usara para diligenciar una celda en excel por otra funcion.

Maneja buenas practicas, comenta para entender la funcion, ya que esto se usara para un proyecto profesional.

}

{5: Necesito crear una funcion la que dependiendo de la calificacion apgar que recibira la funcion como string, me returne una tupla con cuatro fortalezas, cada unidad de la tupla contedra el valor contenido en el diccionario con el que trabajaremos, el diccionario esta compuesto de la calificacion apgar(17 A 20, 16 A 13, 12 A 10, 9) y claves:valor con las descripciones de las frotalezas. 

fortalezas_apgar = {
    "17-20": {
        "FORTALEZA 1": "Los miembros de la familia expresan libremente sus emociones, positivas y negativas. Esta comunicación emocional fortalece los vínculos afectivos y promueve la comprensión, la aceptación y la escucha activa.",
        "FORTALEZA 2": "Existe un diálogo abierto donde se valoran todas las opiniones. La familia resuelve conflictos de forma pacífica, con comprensión mutua y trabajo colaborativo ante desacuerdos cotidianos.",
        "FORTALEZA 3": "La familia se reorganiza de forma efectiva ante cambios o dificultades, tomando decisiones conjuntas y buscando apoyo externo si es necesario. Mantienen una actitud resiliente.",
        "FORTALEZA 4": "Todos los miembros se sienten respaldados y emocionalmente seguros, especialmente en momentos difíciles. El apoyo constante crea un ambiente confiable y protector."
    },
    "16-13": {
        "FORTALEZA 1": "Aunque hay disposición, existen dificultades ocasionales para expresar emociones, lo que puede generar malentendidos y limitar la conexión emocional.",
        "FORTALEZA 2": "Se intenta mantener la comunicación, pero los desacuerdos pueden generar tensiones. A veces se evita abordar los problemas directamente, lo que impide acuerdos duraderos.",
        "FORTALEZA 3": "La familia intenta reorganizarse ante situaciones adversas, aunque con dificultades para manejar el estrés. Puede haber incertidumbre que afecta el funcionamiento familiar temporalmente.",
        "FORTALEZA 4": "Hay reconocimiento del apoyo mutuo, pero no siempre es constante. Pueden surgir sentimientos de soledad o falta de contención emocional en momentos críticos."
    },
    "12-10": {
        "FORTALEZA 1": "La expresión emocional es limitada. Frecuentemente se evitan conversaciones sobre emociones, lo que debilita la empatía y la conexión afectiva.",
        "FORTALEZA 2": "La comunicación es ineficaz. Los conflictos suelen escalar y resolverse de forma poco saludable. Prevalece el silencio, la evasión o reacciones impulsivas.",
        "FORTALEZA 3": "Hay desorganización y poca coordinación frente a dificultades. Las decisiones son fragmentadas, y algunos miembros experimentan sobrecarga emocional.",
        "FORTALEZA 4": "Varios miembros no se sienten apoyados o seguros. En momentos difíciles, puede faltar contención, generando vulnerabilidad emocional, especialmente en los más sensibles."
    },
    "9": {
        "FORTALEZA 1": "Existe una profunda dificultad para compartir emociones. Esto genera aislamiento emocional, resentimientos acumulados y desconexión afectiva.",
        "FORTALEZA 2": "Los conflictos se evitan o se manejan de forma destructiva. No hay espacios seguros de diálogo y la falta de respeto y escucha deteriora la dinámica familiar.",
        "FORTALEZA 3": "La familia no logra reorganizarse ni apoyarse mutuamente ante adversidades. El afrontamiento es individual y caótico, lo que perpetúa una sensación de crisis.",
        "FORTALEZA 4": "El sentimiento de protección es muy bajo. En situaciones difíciles, los miembros se sienten desatendidos, lo que impacta su salud emocional y física."
    }
}

}

{6: Debo crear una funcion que resiba una tupla como parametro de le funcion Tuple[str, str, str, str], esta tupla contendra cuatro textos que se deberan ingregar en 4 celdas en un excel quiero que la funcion sea simple, 
entondes intenta rellenar las celdas individual mente
}

{7: Debo crear una funcion que recibira un diccionario con la siquiente estructura.

   {
            'fecha_visita': [15, 6, 2025],  # la tupla se convierte en lista al serializarla
            'resultado_apgar': '17 A 20',
            'factores': {
                'SOBRECARGA DE CUIDADOR': True,
                'RED DE APOYO COMUNITARIO': False
            }
   }
    


Esta funcion debe identificar los siguientes factores sin tener en cuenta los demas('COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES',
            'INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD',
            'RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO',
            'ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES',
            'RIESGO DE MAL NUTRICIÓN')

La funcion debe identificar cuales estan marcadas con True or False, y debera retornarme una tupla con 4 elementos que contenga los valores contenidos en "hallazgo_identificado", "compromiso_concertado",  "logro_trazador", "logro_intermedio", en caso de no haber ningun valor True entregame el valor contenido en la clave "plantilla_sin_hallazgos" y los 2 elementos restantes con string vacios, estos textos los necesito listo para insertar un una celda de excel, los textos con saltos de linea para que se mas estetico, enseguida le voy a propocionar el diccionario de respuestas:

Ademas comenta el codigo los mejor posible, y maneja buenas practicas de codigo, ya que esta funcion se utilizara en un proyecto profesional.

factores_dict: Dict[str, Dict[str, str]] = {
    "COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES": {
        "hallazgo_identificado": (
            "Presencia de patrones de comunicación no asertiva e inadecuado uso de dispositivos electrónicos, "
            "que interfieren en las dinámicas familiares y afectan la calidad de las interacciones interpersonales."
        ),
        "compromiso_concertado": (
            "Promover espacios cotidianos de diálogo efectivo en el entorno familiar mediante la implementación "
            "de prácticas de comunicación asertiva y la delimitación consensuada de horarios para el uso de dispositivos electrónicos, "
            "con el fin de fortalecer los vínculos afectivos y la salud emocional del hogar."
        ),
        "logro_trazador": (
            "Implementación sostenida de rutinas familiares con al menos una hora diaria sin uso de dispositivos electrónicos, "
            "con evidencia de mejora en la convivencia familiar en un periodo de 6 meses, verificada mediante seguimiento comunitario o visitas domiciliarias."
        ),
        "logro_intermedio": (
            "Participación de al menos un miembro de la familia en una sesión educativa o actividad orientada a fortalecer "
            "la comunicación familiar y el uso saludable del tiempo, dentro de los próximos 90 días."
        ),
       
    },

    "INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD": {
        "hallazgo_identificado": (
            "Baja adherencia a los servicios integrales de atención en salud dentro de la Ruta de Promoción y Mantenimiento de la Salud, "
            "lo cual limita la detección temprana, la intervención oportuna y la continuidad del cuidado."
        ),
        "compromiso_concertado": (
            "Asegurar la vinculación efectiva de todos los miembros del grupo familiar a actividades preventivas y de control de salud, "
            "conforme al curso de vida, mediante la programación, asistencia y seguimiento de atenciones estipuladas por la Resolución 3280 de 2018."
        ),
        "logro_trazador": (
            "Cumplimiento de los controles de salud correspondientes al ciclo vital de cada integrante del núcleo familiar dentro de los próximos 9 meses, "
            "verificado mediante registros clínicos o historia familiar consolidada."
        ),
        "logro_intermedio": (
            "Agendamiento y cumplimiento de al menos una consulta preventiva (médica, odontológica, de enfermería o nutricional) "
            "por integrante familiar en un plazo de hasta 90 días, con acompañamiento del equipo territorial si se requiere."
        ),
        
    },

    "RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO": {
        "hallazgo_identificado": (
            "Riesgo de aislamiento social y deterioro progresivo de la salud física y mental, asociado a la ausencia de redes de apoyo familiar "
            "y a la inestabilidad en prácticas regulares de autocuidado."
        ),
        "compromiso_concertado": (
            "Fortalecer redes de apoyo familiares y comunitarias mediante la participación activa en espacios sociales y actividades colectivas, "
            "favoreciendo la interacción, el bienestar emocional y el sentido de pertenencia."
        ),
        "logro_trazador": (
            "Integración del individuo o grupo familiar a al menos un espacio comunitario (grupo de apoyo, actividad de salud mental o programa local), "
            "con participación activa durante un periodo mínimo de 4 meses, verificado mediante seguimiento comunitario."
        ),
        "logro_intermedio": (
            "Contacto inicial y vinculación con al menos un recurso de apoyo institucional o comunitario en un plazo máximo de 60 días, "
            "con registro por parte del equipo de salud sobre el inicio de dicha participación."
        ),
        
    },

    "ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES": {
        "hallazgo_identificado": (
            "Presencia de procesos de envejecimiento con comorbilidades crónicas y manifestaciones emocionales asociadas a la transición del ciclo vital."
        ),
        "compromiso_concertado": (
            "Asegurar la continuidad del seguimiento clínico y funcional del adulto mayor, garantizando controles médicos, uso adecuado de tratamientos "
            "y atención a su situación emocional y familiar para mejorar su calidad de vida."
        ),
        "logro_trazador": (
            "Estabilidad clínica de enfermedades crónicas con mejora funcional y emocional percibida por el usuario o cuidador "
            "en un periodo de 9 meses, respaldada por evaluación médica o comunitaria."
        ),
        "logro_intermedio": (
            "Asistencia a control médico integral del adulto mayor dentro de los próximos 60 días, con actualización del plan de tratamiento "
            "y orientación sobre autocuidado en el hogar."
        ),
        
    },

    "RIESGO DE MAL NUTRICIÓN": {
        "hallazgo_identificado": (
            "Riesgo nutricional en distintos grupos etarios, evidenciado por malnutrición por exceso o por déficit, asociado a prácticas alimentarias inadecuadas "
            "y desinformación sobre nutrición."
        ),
        "compromiso_concertado": (
            "Promover cambios progresivos en la alimentación familiar mediante orientación práctica sobre consumo adecuado de alimentos locales y accesibles, "
            "favoreciendo una dieta equilibrada y culturalmente apropiada."
        ),
        "logro_trazador": (
            "Mejora en indicadores nutricionales básicos (peso, talla, IMC, perímetro abdominal, según corresponda) en un periodo de 6 a 9 meses, "
            "verificada mediante controles periódicos de seguimiento."
        ),
        "logro_intermedio": (
            "Asistencia a una consulta de valoración nutricional o participación en una charla educativa sobre alimentación saludable "
            "dentro de los próximos 90 días, con implementación de al menos una recomendación práctica en el hogar."
        ),
        
    },

     "plantilla_sin_hallazgos": {
            "Tras la valoración integral familiar, no se evidencian hallazgos negativos y el estado de salud general es adecuado. "
            "El entorno físico es seguro e higiénico, y las relaciones interpersonales dentro del núcleo familiar son armónicas. "
            "Se realizará educación sobre hábitos de vida saludable (alimentación balanceada, actividad física, higiene del sueño y manejo del estrés). "
            "También se abordará la importancia de la comunicación asertiva y la adherencia a controles médicos. "
            "La familia mostró disposición para participar en el proceso educativo y se programará seguimiento según necesidad."
     }
}


}
{8: Necesito crear una funcion que se encargara de recorrer cada integrante de un nucleo familiar, esta funcion debera generar una tupla con los siguientes elementos que se extraeran de los integrantes: "Nombre" y "edad". que seran el elemento [0], [1] de la tupla.

Tambien necesito generar una respuesta que se llamara "hallazgos", "compromisos", "logo trazador" y "logro intermedio" los cuales seran los otros elementos de la TUPLA.

La funcion recibira generara las respuestas teniendo en cuenta el ciclo de edad al que pertenecen, la funcion debe normalizar las edades ya que estas estan definidas como strings. 

En el diccionario se pueden ver las respuestas por ciclo de edad al que pertenecen, estan delimitados.

el elemento [2] de la tupla generada debe contener el ciclo al que pertenece y el texto contenido en "hallazgo".

el elemento [3] de la tupla generada debera contener el texto contenido en "compromiso".

el elemento [4] de la tupla generada debera contener el texto contenido en "logro-trazador".

el elemento [5] de la tupla generada debera contener el texto contenido en "logro intermedio"

Los texto los necesito listos a manera de parrafo, estos seran usados por otra funcion para ser insertados en celdas por otra funcion.

El diccionario donde se extraeran las respuestas es el siguiente:

datos_por_ciclo_vida: Dict[str, Dict[str, str]] = {

    "0 a 5": {
        "ciclo": "PRIMERA INFANCIA",
        "hallazgo": (
            "Se reconocen esfuerzos familiares por atender las necesidades del niño, como la lactancia y el seguimiento de controles. "
            "Sin embargo, persisten prácticas alimentarias mejorables y asistencia irregular a controles. En el hogar, hay condiciones que podrían ajustarse para fortalecer la seguridad y la higiene, especialmente en lo respiratorio y digestivo."
        ),
        "compromiso": "Garantizar alimentación adecuada, asistir a controles, mejorar la seguridad del hogar y fortalecer prácticas de higiene.",
        "logro_trazador": "Cumplimiento del 90% de los controles de crecimiento y vacunación en 6 meses con registros clínicos actualizados.",
        "logro_intermedio": "Evaluación domiciliaria y mejoras mínimas en seguridad e higiene en un plazo de 90 días."
    },
    "6 a 11": {
        "ciclo": "INFANCIA",
        "hallazgo": (
            "Se evidencia una disposición familiar hacia el cuidado y la higiene, aunque con oportunidades para mejorar la regularidad y supervisión. "
            "Se observa consumo moderado de alimentos procesados y uso frecuente de pantallas, así como variabilidad en la actividad física. Estos factores pueden afectar el bienestar y el rendimiento escolar del niño."
        ),
        "compromiso": "Promover alimentación saludable, aumentar actividad física y supervisar hábitos de higiene.",
        "logro_trazador": "Rutinas saludables 5 días por semana con evidencia en controles o registros familiares en 6 meses.",
        "logro_intermedio": "Sesión educativa sobre alimentación, higiene y actividad física en los primeros 90 días."
    },
    "12 a 17": {
        "ciclo": "ADOLESCENCIA",
        "hallazgo": (
            "Se aprecian vínculos familiares presentes y disposición a mejorar la convivencia, aunque se identifican dificultades en la comunicación emocional. "
            "Puede haber exposición a riesgos como sustancias psicoactivas y hábitos irregulares de alimentación, sueño o autocuidado, aspectos que pueden optimizarse con acompañamiento."
        ),
        "compromiso": "Mejorar la comunicación, prevenir conductas de riesgo y establecer rutinas saludables.",
        "logro_trazador": "Mejora en comunicación y reducción de riesgos en evaluación psicosocial o médica en 6 meses.",
        "logro_intermedio": "Sesión grupal o familiar sobre comunicación, autocuidado y prevención en 90 días."
    },
    "18 a 28": {
        "ciclo": "JUVENTUD",
        "hallazgo": (
            "Se evidencia interés por el autocuidado y autonomía en muchos jóvenes, aunque persisten hábitos alimentarios irregulares y niveles variables de actividad física. "
            "La participación en controles de salud es ocasional, y pueden reforzarse el manejo del estrés y la integración en redes familiares o comunitarias de apoyo."
        ),
        "compromiso": "Mejorar alimentación, aumentar actividad física, asistir a controles y fortalecer redes de apoyo.",
        "logro_trazador": "Controles regulares y adopción de hábitos saludables documentados por 6 meses.",
        "logro_intermedio": "Participación en actividades de salud y agendamiento de controles en 90 días."
    },
    "29 a 59": {
        "ciclo": "ADULTEZ",
        "hallazgo": (
            "Muchas personas en esta etapa muestran compromiso con su familia y trabajo, aunque tienden a postergar su bienestar personal. "
            "Son comunes estilos de vida sedentarios, alimentación poco equilibrada y limitada participación en controles médicos, lo que puede afectar la salud emocional y familiar."
        ),
        "compromiso": "Reducir sedentarismo, mejorar la dieta, asistir a controles y promover el bienestar emocional.",
        "logro_trazador": "Estilo de vida activo y alimentación adecuada, reflejado en evaluaciones y registros en 6 meses.",
        "logro_intermedio": "Asistencia a control médico y actividad de bienestar emocional dentro de 90 días."
    },
    ">60": {
        "ciclo": "VEJEZ",
        "hallazgo": (
            "En esta etapa, muchas personas conservan su funcionalidad con el apoyo de su familia. Aun así, se presentan algunas limitaciones en la movilidad, hábitos alimentarios que pueden optimizarse y menor participación social. "
            "El acceso a servicios de salud puede ser intermitente, por lo que fortalecer el acompañamiento familiar y comunitario es clave."
        ),
        "compromiso": "Promover movilidad, mejorar alimentación, asegurar acceso a salud y fortalecer acompañamiento social y familiar.",
        "logro_trazador": "Mejora o mantenimiento de funcionalidad y bienestar reflejado en controles y valoración familiar en 6 meses.",
        "logro_intermedio": "Plan de actividades físicas y acompañamiento con seguimiento familiar en 90 días."
    }
}
}

{9: Ayudame a crear una funcion que recibira una variable con la siguiente estructura (List[Tuple[str, int, str, str, str, str]]:)
    Esta funcion se encargara de rellenar una serie de celdas que estan en el mismo orden de la lista de tuplas.
    celdas = "C44", "F44", "G44", "L44", "U44", "V44".

    La lista de tuplas contendra tuplas que pueden variar segun el nucleo familiar.

    EL area en la hoja de calculo asignada para rellenar cuenta con 10 filas en total.

    La funcion debe asignar una tupla por fila
     
}
 {
    ayudame a generar una funcion que generara una tupla con los textos (hallazgo, compromiso, logro trazador, logro intermedio)
    basada únicamente en los valores booleano del factor "ACTIVIDADES DEPORTIVAS COMUNITARIAS", "ACTIVIDADES LÚDICAS Y CULTURALES COMUNITARIAS".

 }

 {
    Crea una Funcion que se encargara de generar una tupla con dos elementos.

    el primero elemento contendra el valor contenido en "hallazgos" mas el valor contenido en "implementacion".

    el segundo elemento contendra el valor contenido en "cierre".

    la funcion debera tener en cuenta para generar los textos. los factores encontrados por nucleo,tendra en cuenta solo los que esten asignados como true:

    "COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES",
    "INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD",
    "RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO",
    "ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES",
    "RIESGO DE MAL NUTRICIÓN",
    
    los siguientes factores se deberan asumir al contrario, generara los textos solo con los factores marcados como false:
    
    "ACTIVIDADES DEPORTIVAS COMUNITARIAS",
    "ACTIVIDADES LÚDICAS Y CULTURALES COMUNITARIAS",
    "RED DE APOYO COMUNITARIO",

    El diccionario que se usara para generar los textos es el siguiente:

    DICT_FACTORES_CUIDADO = {
    "COMUNICACION NO ASERTIVA, USO INADECUADO DE PANTALLAS LO CUAL DIFICULTA LAS INTERACCIONES FAMILIARES": {
        "hallazgo": "Presencia de patrones de comunicación no asertiva e inadecuado uso de dispositivos electrónicos, lo que interfiere en las dinámicas familiares y limita la calidad de las interacciones interpersonales.",
        "implementacion": "Se implementarán encuentros educativos durante las visitas domiciliarias. Se promoverán prácticas de comunicación respetuosa y escucha activa entre los miembros de la familia. Además, se orientará sobre el uso equilibrado de la tecnología y la importancia de compartir tiempos sin pantallas. Se fomentará el fortalecimiento de vínculos afectivos y espacios de diálogo familiar. Todo con enfoque participativo y adaptado al contexto familiar.",
        "cierre": "Se considera finalizado el proceso cuando se evidencia una disminución de los conflictos interpersonales y una mejora en la comunicación emocional asertiva. Asimismo, se observa continuidad en las prácticas saludables adoptadas, incluyendo avances en parámetros de salud básica. El cierre también se sustenta en la apropiación de estrategias de autorregulación emocional y digital, mantenidas en el tiempo. Finalmente, se reconoce una mayor estabilidad emocional y una actitud proactiva para solicitar apoyo profesional cuando sea necesario."
    },
    "INASISTENCIA A SERVICIOS DE SALUD DENTRO DEL MARCO DE LOS SERVICIOS DE LA RUTA DE PROMOCION Y MANTENIMIENTO DE LA SALUD": {
        "hallazgo": "Baja adherencia a los servicios integrales de atención en salud en el marco de la Ruta de Promoción y Mantenimiento de la Salud, lo que limita la detección temprana, la intervención oportuna y la continuidad del cuidado.",
        "implementacion": "Se realizarán visitas domiciliarias con educación en salud adaptada a la familia. Se explicará la importancia de los controles, vacunación y prevención de enfermedades. Se identificarán barreras y se gestionarán apoyos para facilitar el acceso a los servicios. La familia será parte activa del proceso, promoviendo su corresponsabilidad. Todo se hará con enfoque comunitario y culturalmente pertinente.",
        "cierre": "Se considera cerrado cuando la familia demuestra mejoras sostenidas en la comunicación, con prácticas más asertivas y mayor disposición al diálogo respetuoso. Se observa una reducción del uso inadecuado de dispositivos electrónicos y un aumento en las interacciones presenciales de calidad. Además, la familia reconoce la importancia del equilibrio entre tecnología y convivencia. Estos cambios se evidencian de forma estable durante las visitas de seguimiento."
    },
    "RIESGO DE AISLAMIENTO SOCIAL Y DETERIORO EN SU SALUD FÍSICA Y MENTAL DEBIDO A LA FALTA DE APOYO FAMILIAR CONSTANTE Y HÁBITOS IRREGULARES DE AUTOCUIDADO": {
        "hallazgo": "Riesgo de aislamiento social y deterioro progresivo de la salud física y mental, asociado a la ausencia de redes de apoyo familiar y a la inestabilidad en prácticas regulares de autocuidado.",
        "implementacion": "Se promoverá la reconstrucción de redes de apoyo a través del acompañamiento psicosocial en visitas domiciliarias. Se fortalecerán rutinas de autocuidado mediante orientación personalizada y seguimiento periódico. Además, se fomentará la vinculación con actividades comunitarias y servicios disponibles en el territorio. La intervención buscará mejorar la estabilidad emocional y la participación activa en su proceso de cuidado. Todo se realizará con enfoque humanizado, familiar y comunitario.",
        "cierre": "Se considera cerrado cuando se evidencia una mayor participación del individuo en espacios comunitarios y sociales, así como la activación de redes de apoyo formales o informales. Se observan mejoras en las rutinas de autocuidado y un compromiso sostenido con el seguimiento de su salud física y mental. Además, se identifica mayor autonomía, estabilidad emocional y disposición para buscar ayuda oportuna. Estos avances se mantienen de forma constante durante el acompañamiento."
    },
    "ENVEJECIMIENTO, ENFERMEDADES CRÓNICAS Y CAMBIOS EMOCIONALES": {
        "hallazgo": "Presencia de procesos de envejecimiento con comorbilidades crónicas y manifestaciones emocionales asociadas a la transición del ciclo vital.",
        "implementacion": "Se implementará un plan de cuidado centrado en el acompañamiento integral durante las visitas domiciliarias. Se fortalecerá el autocuidado y la adherencia al tratamiento, así como la expresión emocional y adaptación a los cambios del ciclo vital. Se promoverá la participación en redes de apoyo comunitario y espacios de socialización. Además, se articulará con programas de atención al adulto mayor para garantizar seguimiento continuo. Todo con enfoque biopsicosocial y centrado en la dignidad del envejecimiento.",
        "cierre": "Se considera cerrado cuando la persona mayor muestra adherencia al tratamiento de sus comorbilidades, estabilidad en su estado de salud y participación activa en su proceso de autocuidado. Se evidencia aceptación progresiva de los cambios propios del ciclo vital y manejo adecuado de las emociones asociadas. Además, cuenta con acompañamiento familiar o comunitario que respalda su bienestar integral. Estos logros se mantienen durante las visitas de seguimiento y no requieren intervenciones adicionales intensivas."
    },
    "RIESGO DE MAL NUTRICIÓN": {
        "hallazgo": "Riesgo nutricional en diferentes grupos etarios, con manifestaciones de malnutrición por exceso o por déficit, asociado a prácticas alimentarias inadecuadas y desinformación nutricional.",
        "implementacion": "Se desarrollarán intervenciones educativas durante las visitas domiciliarias, enfocadas en mejorar las prácticas alimentarias y corregir desinformación nutricional. Se brindarán recomendaciones adaptadas según la edad, condición de salud y contexto familiar. Además, se promoverá el acceso a alimentos saludables y se articulará con servicios de apoyo nutricional comunitario. El seguimiento será continuo y orientado a fortalecer hábitos sostenibles. Todo con enfoque preventivo, familiar y culturalmente pertinente.",
        "cierre": "Se considera cerrado cuando los integrantes de la familia adoptan prácticas alimentarias más equilibradas, ajustadas a su grupo etario y condición de salud. Se observa mejoría en los indicadores nutricionales, ya sea por la recuperación de peso saludable o la reducción del exceso. Además, demuestran comprensión de las recomendaciones brindadas y aplican de forma autónoma hábitos de alimentación adecuados. Estos cambios se sostienen en el tiempo y se refuerzan en cada seguimiento."
    },
    "ACTIVIDADES DEPORTIVAS COMUNITARIAS": {
        "hallazgo": "No cuenta con actividades deportivas comunitarias.",
        "implementacion": "Se promoverá la activación de espacios locales para la práctica de actividad física mediante el trabajo conjunto con líderes comunitarios y entidades territoriales. Durante las visitas domiciliarias se orientará a las familias sobre la importancia del ejercicio regular para la salud física y mental. Se sugerirán rutinas sencillas que puedan realizarse en el hogar o en espacios abiertos del barrio. Además, se fomentará la organización de grupos comunitarios para caminatas, juegos o pausas activas. Todo con enfoque participativo y de promoción de la salud.",
        "cierre": "Se considera cerrado cuando la familia o sus miembros participan activamente en espacios comunitarios de actividad física o han incorporado rutinas de ejercicio en su entorno cercano. Se evidencia comprensión de los beneficios del movimiento regular para la salud y se mantiene una práctica constante, adecuada a la edad y condición física. Además, se fortalecen vínculos con la comunidad a través de estas actividades. Estos cambios se sostienen durante las visitas de seguimiento."
    },
    "ACTIVIDADES LÚDICAS Y CULTURALES COMUNITARIAS": {
        "hallazgo": "No cuenta con actividades lúdicas y culturales comunitarias.",
        "implementacion": "Se impulsará la gestión y promoción de espacios participativos en articulación con líderes locales, instituciones educativas y entidades culturales. Durante las visitas domiciliarias se motivará a las familias a participar en actividades recreativas que fortalezcan la identidad, la convivencia y el bienestar emocional. Se propondrán iniciativas sencillas como encuentros barriales, juegos tradicionales o talleres artísticos. Además, se promoverá la integración intergeneracional como herramienta de cohesión social. Todo con enfoque comunitario, participativo y culturalmente pertinente.",
        "cierre": "Se considera cerrado cuando la familia participa de manera activa en actividades lúdicas o culturales disponibles en la comunidad, o ha desarrollado espacios recreativos propios en su entorno. Se reconoce el valor de estas prácticas para fortalecer los lazos familiares, el bienestar emocional y la integración social. Además, se promueve la continuidad de estas acciones como parte de su dinámica habitual. Estos avances se mantienen de forma estable en los seguimientos realizados."
    },
    "RED DE APOYO COMUNITARIO": {
        "hallazgo": "No cuenta con red de apoyo comunitario.",
        "implementacion": "Se promoverá la identificación y fortalecimiento de vínculos con vecinos, líderes locales y actores sociales del territorio. Durante las visitas domiciliarias se orientará a la familia sobre la importancia del apoyo mutuo y la participación en espacios comunitarios. Se fomentará la vinculación con grupos organizados, comités locales o iniciativas solidarias existentes. Además, se articulará con entidades e instituciones que favorezcan la construcción de redes de cuidado. Todo con enfoque comunitario, participativo y sostenible.",
        "cierre": "Se considera cerrado cuando la familia ha logrado establecer vínculos con redes de apoyo comunitario formales o informales, como vecinos, grupos locales o instituciones del territorio. Se evidencia mayor participación en espacios comunitarios y disposición para solicitar ayuda cuando es necesario. Además, se fortalecen los lazos de solidaridad y corresponsabilidad en su entorno. Estos cambios se mantienen y se reafirman durante las visitas de seguimiento."
    }
}

la siguiente es un ejemplo de la estrutura de los factores contenidos en el nucleo familia es la siguiente:

'factores': {
                'SOBRECARGA DE CUIDADOR': True,
                'RED DE APOYO COMUNITARIO': False
            }
 
 
 ** Necesito el codigo bien comentado para entenderlo mejor, ya que se usara en un proyecto profesional.
 
 
 }